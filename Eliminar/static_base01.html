


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 5.0 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>NOVA Precarga</title>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <link href="/FW/css/base.css" type="text/css" rel="stylesheet" />
    <link href="/precarga/css/cabe_precarga.css" type="text/css" rel="stylesheet" />
    <link href="css/precarga.css" type="text/css" rel="stylesheet" />
    <link rel="shortcut icon" href="FW/image/icons/nv_login.ico" />
    <script type="text/javascript" src="/FW/script/nvFW.js"></script>
    <script type="text/javascript" src="/FW/script/nvFW_windows.js"></script>
    <script type="text/javascript" src="/FW/script/nvFW_BasicControls.js"></script>
    <script type="text/javascript" src="/FW/script/tCampo_def.js"></script>
    <script type="text/javascript" src="/precarga/script/tCampo_head.js"></script>

    <script type="text/javascript" src="script/precarga.js"></script>

    <script type='text/javascript' language='javascript' id='nvPageBase_HeadInit' name='nvPageBase_HeadInit'>
var obj = window;
if (!!nvFW)
  obj = nvFW;
  obj.pageContents = {
"creditos_mostrar":'<enc><![CDATA[fD/ypVyWgqJRmq092713Yp7a/Y4bVTR8b1RPGAFWGJpdydEKdcXRBDIy7P3rZpfetIFxxPQ0PHLNb4iAGE+BUcON2gaCs0xfWIuuhn99p2/7DGKQQ1OhduLR9eGfMCDBbAMBJJO82A19u2Whc1d+G33Yega9VjfYUs1HBNibNV5y2KZDLC/QANcc97pBRNESo4jpkk6EWItlF9Ag0Z9UZjEyUgsait6NcENZ/FdDzoZOSyXYcqaDDrMKpGQkGzvAFBsaai3hMHehMVjrC89jCmTqzK2JC78+opSYnjuTN3ncHXpwj8ik6EpKdnegPGKCeTzDL9jKi3Rr0Dda5ssgPmHXdce9T/j6PnP7jTzXlgQ3+vLqR+kO+Dl4VeAEQLk6TAKihaHrMPOPNdHCBf7qnb0dktcwhKVJxI7wRl8bghcPN+WMheaAq1/pWdK4WkMATMbOEJKUfrTm3fOx56dG+tsG8brZfohAxsyyV8Clb0I=]]></enc>'
,"estados":'<enc><![CDATA[fD/ypVyWgqJRmq092713YkVwkOjnqMOKgg+qAnLW8ml2CBrpZI46kL07MKZ2Ip3TAP17DIykEDSVdEsaLVPuYLghiocaAc0MQaEtODEqXbPTjoG9tIqVmN2PIR7Xu3cJ7lVUVRadYp7xJrIsTuu6MJ0xGjo4LsZ5QwCWRxbE+YCwhqnNn6ncPxFBVZ6x3D99GVuZw+NCiHqPCIYrewoW6H/E8m8lJ+M0XC4mIpHSy6s3Wn8pmYZ5zi3eZjOz1rbKp1e+WRolwE0JbPalNI+xLEmwLXpUbqJvS+yvwPvWSdD5G2YsRHLiHxoYX5iURp3SVx6VT/XVu0G2MaUnJocqnQ==]]></enc>'
,"creditos_mostrar_exp":'<enc><![CDATA[fD/ypVyWgqJRmq092713Yp7a/Y4bVTR8b1RPGAFWGJo8GbaEYwqb411s+lYTNzRV+S5Pi4SIL9AHfMBoKlePlSZFx9vSqVQtxoGlD/+XCpKd15+VNv/mNfUCauBKXiTRY1v5DSgNzbE1C/HU/rhDL4WzboMZ1dAYaUAUnbwf1E8yCQKYot1vpOqDhj2LaIkiXUWxsPJhDBZthxl4brQuUWR/Xe3ul4LYv8LKEhj6jdi9x7dDqEJpfgiohxaR/V5uKnHFtZZ/oZoRw0GmGmqusgWSv1SKc3OkkT39UfLK0WoZEfMl0Dl/EYe/q53LxXU6CNnYZk69wdtebFqhWUsObo7SQCJpGqT1tmydsQrCpUbBAx4l8OaWqXhmFSS9g4KnYOcbotaio81ppKMIZ4kV0dwimfJkmoSx3DoOOgukW72rTtqfZHhRybVU18O6RJUxSG9nxLjcISRf9ZWBP9SggtrVNXCI64tgX25gaXMuJ3vK2MGt/PcF69mwhAi9Evd7Pw3aFYtmmytbFdTEu4TIPA==]]></enc>'
,"dependientes_vendedor":'<enc><![CDATA[fD/ypVyWgqJRmq092713YqXEO7UG5beMv/0yJTJ/1Dm0uv9eXYjMZ9upp/tqG+jRQPJPsmyc70GPoZW4X1mGkLu8COPCbAUbo0Rn4SSLbD5EXSR6yIlzaOzYTb3xKkZ6hCWzDFSQ3iRUFWW9yRuc7bfTOPCGlQApTwHJ+p6v0T3Jun7uMR0n5DRCk2fSkN0V]]></enc>'
};

obj.permiso_grupos = {};

    </script>

    <script type='text/javascript' language='javascript' id='nvPageAdmin_HeadInit' name='nvPageAdmin_HeadInit'>
var nro_operador = '114'
var login = 'jmolivera'
var sucursal_defecto = 'Sta Fe - Oficina'
var app_cod_sistema = 'nv_mutualprecarga'
var cfg_server_name = 'dev2.redmutual.com.ar'
var UID = 'jmolivera'
    </script>


    <script type="text/javascript" language="javascript" class="table_window">

    var alert = function (msg) { Dialog.alert(msg, { className: "alphacube", width: 300, height: 100, okLabel: "cerrar" }); }
    var win = nvFW.getMyWindow()

    var vButtonItems = {}
    vButtonItems[0] = {}
    vButtonItems[0]["nombre"] = "Buscar";
    vButtonItems[0]["etiqueta"] = "Buscar";
    vButtonItems[0]["imagen"] = "buscar";
    vButtonItems[0]["onclick"] = "return verCreditos(modo)";
    vButtonItems[1] = {}
    vButtonItems[1]["nombre"] = "Exportar";
    vButtonItems[1]["etiqueta"] = "Exportar";
    vButtonItems[1]["imagen"] = "excel";
    vButtonItems[1]["onclick"] = "return Exportar()";

    var vListButtons = new tListButton(vButtonItems, 'vListButtons');
    vListButtons.loadImage("buscar", "/precarga/image/search_16.png");
    vListButtons.loadImage("excel", "/FW/image/icons/excel.png");

        var nro_vendedor = 0;
        var nro_docu = 0;
        var WinTipo = '';
        var modo = '';
        var ismobile = false;
        var fe_desde = '';
        var dependientes = "";
        var BodyWidth = 0;

    function window_onload()
    {
        vListButtons.MostrarListButton()
        filtros = win.options.userData.filtros
        modo = filtros['modo']
        nro_vendedor = filtros['nro_vendedor']
        nro_docu = filtros['nro_docu']
        BodyWidth = filtros['BodyWidth']
        window_onresize()
     //   campos_defs.add("estados", { nro_campo_tipo: 2, target: "tdestados", enDB: false, cacheControl:'nvFW', filtroXML: nvFW.pageContents.estados })
        campos_defs.set_value('estados_precarga', "'P','H','M','R','6'")
        fe_desde = new Date()
        fe_desde.setDate(1)
        $('fecha_desde').value = FechaToSTR(fe_desde)

    }

    function verCreditos(modo)
    {
        dependientes = 0
        var rs = new tRS()
        rs.open({ filtroXML: nvFW.pageContents.dependientes_vendedor, params: "<criterio><params nro_vendedor='" + nro_vendedor + "' /></criterio>" })
        if (!rs.eof()) {
            dependientes = rs.getdata("dependientes")
        }

        var filtro = "<estado type='in'>'1','2','A', 'D', 'E', 'G', 'H', 'L', 'M', 'O', 'P', 'Q', 'R', 'T', 'U', 'Z'</estado>"
       // dependientes = "<nro_vendedor type='sql'><![CDATA[nro_vendedor in (select dbo.rm_vendedor_dependencia(" + nro_vendedor + "))]]></nro_vendedor> "
        var estados = ''

        estados = $('estados_precarga').value

        if (($('fecha_desde').value == '') && ($('fecha_hasta').value == '') && (estados == '') && ($('nro_credito').value == '') && ($('nro_docu').value == ''))
            {
            nvFW.alert('Ingrese un filtro para realizar la búsqueda')
            return
            }

        if ($('fecha_desde').value != '')
            filtro += "<fe_estado type='sql'><![CDATA[fe_estado >= convert(datetime,'" + $('fecha_desde').value + "',103)]]></fe_estado>"

        if ($('fecha_hasta').value != '')
            filtro += "<fe_estado type='sql'><![CDATA[fe_estado < convert(datetime,'" + $('fecha_hasta').value + "',103)+1]]></fe_estado>"

        if (modo == 'V')
            filtro += "<nro_vendedor type='sql'><![CDATA[nro_vendedor in ("+dependientes+")]]></nro_vendedor> " //"<nro_vendedor type='in'>" + dependientes + "</nro_vendedor>"
        if (modo == 'S')
            $('nro_docu').value = nro_docu
            //filtro += "<nro_docu type='igual'>" + nro_docu + "</nro_docu>"

        if (estados != '')
            filtro += "<estado type='in'>" + estados + "</estado>"

        if ($('nro_credito').value != '')
            filtro += "<nro_credito type='igual'>" + $('nro_credito').value + "</nro_credito>"

        if ($('nro_docu').value != '')
            filtro += "<nro_docu type='igual'>" + $('nro_docu').value + "</nro_docu>"

        var page = 9
        if (isMobile()) {
            page = 3
        }
        nvFW.exportarReporte({
            filtroXML: nvFW.pageContents.creditos_mostrar,
            filtroWhere: "<criterio><select PageSize='" + page + "'><filtro>" + filtro + "</filtro></select></criterio>",
            //params: "<criterio><params  /></criterio>",
            path_xsl: 'report\\verCreditos\\HTML_creditos_precarga.xsl',
            formTarget: 'iframe_cr',
            nvFW_mantener_origen: true,
            bloq_contenedor: $(document.documentElement),
            bloq_msg: 'Realizando búsqueda...'
        })

   //     window.webkit.messageHandlers.nvInterOp.postMessage("Buscar vededores");

    }

    function Exportar()
    {
        var filtro = "<estado type='in'>'1','2','A', 'D', 'E', 'G', 'H', 'L', 'M', 'O', 'P', 'Q', 'R', 'T', 'U', 'Z'</estado>"

        var estados = ''

        estados = $('estados_precarga').value

        if (($('fecha_desde').value == '') && ($('fecha_hasta').value == '') && (estados == '') && ($('nro_credito').value == '') && ($('nro_docu').value == ''))
            {
            nvFW.alert('Ingrese un filtro para realizar la búsqueda')
            return
            }

        if ($('fecha_desde').value != '')
            filtro += "<fe_estado type='sql'><![CDATA[fe_estado >= convert(datetime,'" + $('fecha_desde').value + "',103)]]></fe_estado>"

        if ($('fecha_hasta').value != '')
            filtro += "<fe_estado type='sql'><![CDATA[fe_estado < convert(datetime,'" + $('fecha_hasta').value + "',103)+1]]></fe_estado>"

        if (modo == 'V')
            filtro += "<nro_vendedor type='in'>" + dependientes + "</nro_vendedor>"
        if (modo == 'S')
            $('nro_docu').value = nro_docu
            //filtro += "<nro_docu type='igual'>" + nro_docu + "</nro_docu>"

        if (estados != '')
            filtro += "<estado type='in'>" + estados + "</estado>"

        if ($('nro_credito').value != '')
            filtro += "<nro_credito type='igual'>" + $('nro_credito').value + "</nro_credito>"

        if ($('nro_docu').value != '')
            filtro += "<nro_docu type='igual'>" + $('nro_docu').value + "</nro_docu>"

        nvFW.exportarReporte({
                        filtroXML: nvFW.pageContents.creditos_mostrar_exp,
                        filtroWhere: "<criterio><select><filtro>" + filtro + "</filtro></select></criterio>",
                        path_xsl: "report\\EXCEL_base.xsl",
                        salida_tipo: "adjunto",
                        ContentType: "application/vnd.ms-excel",
                        formTarget: "_blank",
                        filename: "creditos_" + nro_vendedor + ".xls",
                        export_exeption: "RSXMLtoExcel",
                        content_disposition: "attachment"
                        ,requestMethod: "GET"
                    })
    }

    var win_estado

    function MostrarCredito(nro_credito)
    {
        var filtros = {}
        filtros['nro_credito'] = nro_credito
        win_estado = window.top.createWindow2({
            url: 'Credito_cambiar_estado.aspx?codesrvsw=5',
            title: '<b>Crédito: ' + nro_credito + ' </b>',
            centerHFromElement: parent.$("contenedor"),
            parentWidthElement: parent.$("contenedor"),
            parentWidthPercent: 0.9,
            parentHeightElement: parent.$("contenedor"),
            parentHeightPercent: 0.9,
            maxHeight: 500,
            minimizable: false,
            maximizable: false,
            draggable: true,
            resizable: true,
            onClose: MostrarCredito_onClose
        });
        win_estado.options.userData = { filtros: filtros }
        win_estado.showCenter(true)
    }

    function MostrarCredito_onClose()
    {
        var retorno = win_estado.options.userData.res
        if (retorno)
            verCreditos(modo)
    }

    function Aceptar(estado)
    {
        var datos_solicitud = {}
        datos_solicitud['estado'] = estado
        win.options.userData = { datos_solicitud: datos_solicitud }
        win.close()
    }

    function window_onresize() {
        try {
            var dif = Prototype.Browser.IE ? 5 : 2
            body_height = $$('body')[0].getHeight()
            div_filtro = $('divFiltro').getHeight()
            $('containerDiv').setStyle({ height: body_height - dif - 2 + 'px' })
            $('iframe_cr').setStyle({ height: body_height - div_filtro - dif - 10 + 'px' })
        }
        catch (e) { }
    }

    </script>
</head>
<body onload="return window_onload()" onresize="return window_onresize()" style="height: 100%; overflow: hidden; background-color:white">
    <div style="overflow:auto;-webkit-overflow-scrolling:touch;" id="containerDiv">
        <div id="divFiltro">
            <div id="divCrFiltroFecha">
                <table class='tb1' id="tbFiltro03">
                    <tr>
                        <td class='Tit1' style="width:50%">Fecha</td>
                    </tr>
                    <tr>
                        <td><table style="width:100%"><tr><td style="width:50%">
                        <script type="text/javascript">campos_defs.add('fecha_desde', { enDB: false, nro_campo_tipo: 103 })</script></td><td>-</td><td>
                        <script type="text/javascript">campos_defs.add('fecha_hasta', { enDB: false, nro_campo_tipo: 103 })</script></td></tr></table></td>
                    </tr>
                </table>
            </div>
            <div id="divCrFiltroLeft">
                <table class='tb1' id="tbFiltro01">
                    <tr>
                        <td class='Tit1' style="width:25%">Crédito</td>
                        <td class='Tit1' style="width:25%">Documento</td>
                    </tr>
                    <tr>
                        <td><input type="number" name="nro_credito" id="nro_credito" style="width: 100%; text-align: right" maxlength="10" /></td>
                        <td><input type="number" name="nro_docu" id="nro_docu" style="width: 100%; text-align: right" maxlength="10" /></td>
                    </tr>
                </table>
            </div>

            <div id="divCrFiltroRight">
                <table class='tb1' id="tbFiltro02">
                    <tr>
                        <td class='Tit1' style="width:50%">Estado</td>
                        <td style="vertical-align:middle;width:25%"><div id="divExportar"></div></td>
                    </tr>
                    <tr>
                        <td id="tdestados">
                            <!--<span id="spestados"></span>-->
                            <!--<select multiple="multiple" size="1" style="width:100%" id="estados"></select>-->
                            <table id='campo_def_tbestados_precarga' class='tb1' cellspacing='0' cellpadding='0' style='width: 100%' border='0'><tr><td style='width: 100%;white-space:nowrap;'><input type='hidden' id='estados_precarga' /><input class='' type='text' id='estados_precarga_desc' style='width: 100%;padding-right: 17px;' placeholder='' readonly='true' ontouchstart='return campos_defs.onclick(event, "estados_precarga")' onblur='campos_defs.onblur("estados_precarga")' ondblclick='return campos_defs.onclick(event, "estados_precarga")' /><img src='/FW/image/campo_def/down.png' class='img_down' border='0' align='absmiddle' hspace='1' id='img_down' ontouchstart='return campos_defs.onclick(event, "estados_precarga")' onclick='return campos_defs.onclick(event, "estados_precarga")'></td>
                        </td>
                        <td><img src='/FW/image/campo_def/cancelar.png' title='Limpiar' class='img_clear' readonly='true' onclick='return campos_defs.clear("estados_precarga")'></td>
                    </tr>
                </table>
                <script>
campos_defs.add('estados_precarga', {
"target":''
,"nro_campo_tipo":2
,"depende_de":''
,"vistaGuardada":''
,"filtroWhere":'<estado  type=\'in\'>%campo_value%</estado>'
,"filtroXML":'<enc><![CDATA[fD/ypVyWgqJRmq092713YmlVJGfiHGapIXPNQ+K2NIKwbK8DSdZ9XKLWkIv7wAajc47H+pfEyEZticZa0/e9NigPTm/+dfdCDp511eDnaE+RreztpN8qXZKqhcbZm3PwtE8d/htZ6LmjLfOrlm21RgcRaLAPn7k4SXF1i/bAXB9WZ/LwmITIM+zS5bGf3q6vyhBDU2nJHRymnDhiGU6JlQleQemZSIK14Slwwx1OF1cvWNhkr7gGwEX7ksKREUi3Aakcd183u9DH9EfFWD4JjeFThz1TLA5dKMjNr4ZWO+858/KnzFrcuAltONL1U6DL0seUMdptgeGdDpgg6RZ9Bsq/UJ70dD39saUoIjPLNj4=]]></enc>'
,"depende_de_campo":''
,"permite_codigo":false
,"json":false
,"cacheControl":'none'
,"StringValueIncludeQuote":false
,"enDB":false
,"autocomplete":false
,"native_autocomplete":false
,"placeholder":''
})
                </script>

                </td>
                <td style="vertical-align:middle;width:25%"><div id="divBuscar"></div></td>
                </tr>
                </table>
            </div>
        </div>
        <!--onkeypress="return btnBuscar_trabajo_onclick(event)"-->

        <iframe name="iframe_cr" id="iframe_cr" style='width: 100%;' frameborder="0" src="/fw/enBlanco.htm"></iframe>
    </div>
</body>
</html>
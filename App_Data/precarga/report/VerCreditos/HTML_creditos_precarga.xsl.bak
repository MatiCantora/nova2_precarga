<?xml version="1.0" encoding="iso-8859-1"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
				xmlns:s="uuid:BDC6E3F0-6DA3-11d1-A2A3-00AA00C14882"
				xmlns:rs='urn:schemas-microsoft-com:rowset'
				xmlns:z='#RowsetSchema'
				xmlns:msxsl="urn:schemas-microsoft-com:xslt"
	            xmlns:foo="http://www.broadbase.com/foo" extension-element-prefixes="msxsl" exclude-result-prefixes="foo">
  <xsl:include href="..\..\..\fw\report\xsl_includes\js_formato.xsl"/>
  <xsl:include href="..\..\..\fw\report\xsl_includes\vb_nvPageXSL.xsl" />
  <xsl:include href="..\..\..\fw\report\xsl_includes\vb_campo_def.xsl" />
    <xsl:output method="html" version="1.0" encoding="Latin-1" omit-xml-declaration="yes"/>

    <xsl:template match="/">
        <html>
            <head>
                <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>

                <title>Créditos</title>
              <link href="/fw/css/base.css" type="text/css" rel="stylesheet"/>
              <link href="/precarga/css/cabe_precarga.css" type="text/css" rel="stylesheet" />
              <link href="/precarga/css/precarga.css" type="text/css" rel="stylesheet" />
              <script type="text/javascript" src="/fw/script/nvFW.js" language="JavaScript"></script>
              <script type="text/javascript" src="/fw/script/tCampo_def.js" language="JavaScript"></script>
              <script type="text/javascript" src="/precarga/script/tCampo_head.js" language="JavaScript"></script>
              <script type="text/javascript" src="/precarga/script/precarga.js" ></script>
                <script language="javascript" type="text/javascript">
                    campos_head.id_exp_origen = '<xsl:value-of select="xml/id_exp_origen"/>'
                    var mantener_origen = '<xsl:value-of select="xml/mantener_origen"/>'
                    campos_head.cacheID = '<xsl:value-of select="xml/params/@cacheID"/>'
                    campos_head.cacheControl = '<xsl:value-of select="xml/params/@cacheControl"/>'
                    campos_head.recordcount = <xsl:value-of select="xml/params/@recordcount"/>
                    campos_head.PageCount = <xsl:value-of select="xml/params/@PageCount"/>
                    campos_head.PageSize = <xsl:value-of select="xml/params/@PageSize"/>
                    campos_head.AbsolutePage = <xsl:value-of select="xml/params/@AbsolutePage"/>
                    campos_head.orden = '<xsl:value-of select="xml/params/@orden"/>'
                  if (mantener_origen == '0')
                    campos_head.nvFW = window.parent.nvFW
                </script>
                <script type="text/javascript"  language="javascript" >
                    <xsl:comment>

                        <![CDATA[
					    function  window_onload()
                          {
                            window_onresize()
                          }
                          
						  function window_onresize()
					        {
					         try
					            {
            			    var divFiltro_h = (isMobile()) ? parent.$('tbFiltro01').getHeight()*3 : parent.$('tbFiltro01').getHeight()*2                      
                      var bodyHeight = parent.$$('body')[0].getHeight()
                      parent.$('iframe_cr').setStyle({ height: bodyHeight - divFiltro_h - 8 + 'px' })
                      var iframe_h = parent.$('iframe_cr').getHeight()
                      var tbCabe_height = $('tbCabe').getHeight() 
                      var tbPage_height = $('tbPages').getHeight()
                      $('div_lst_creditos').setStyle({ height: iframe_h - tbCabe_height - tbPage_height + 'px' })
					            }
					         catch(e){}
					       }
					     
					     function tdScroll_hide_show(show)
                          {
                           var i = 1
                           while(i <=  campos_head.recordcount)
                             {
                              if(show &&  $('tdScroll'+ i) != undefined)
                                 $('tdScroll'+ i).show() 
                                      
                              if(!show &&  $('tdScroll'+ i) != undefined)
                                 $('tdScroll'+ i).hide() 
                                   
                              i++
                             }
                          }            
                          
					       
                 function pag_seleccionar(id)
					       {
					         $(id).addClassName('tr_cel')
					       }
                 
                 function pag_no_seleccionar(id)
                 {
                   $(id).removeClassName('tr_cel')
                 }
                 
					      function mostrar_creditos(e,nro_credito,link)
					      {
                            var path = "../../meridiano/credito_mostrar.asp?nro_credito=" + nro_credito
                            var descripcion = '<b>Crédito Nº ' + nro_credito + '</b>'                            
                            $(link).style.color = '#848484'
                            $(link).style.textDecoration = 'underline'
                            $(link).style.cursor = 'pointer'                           
                            $(link).target = '_blank'
                            $(link).href = path;                                 
					      }					
                
                function MostrarCredito(nro_credito)
                {
                nvFW.selection_clear()
                window.parent.MostrarCredito(nro_credito)
                }
					     
					   ]]>
                    </xsl:comment>
                </script>
            </head>
            <body onload="window_onload()" onresize="return window_onresize()" style="width:100%;height:100%;overflow:auto">                    
                      <table width="100%" class="tb1" id="tbCabe">
                        <tr class="tbLabel">
                          <td style='text-align: center; width: 25px' >-</td>
                          <td style='text-align: center;width:20%'>Nro</td>
                          <td style='text-align: center;width:35%' rowspan='true'>Socio</td>
                          <td style='text-align: center;width:35%' rowspan='true'>Estado</td>
                        </tr>
                      </table>
              <div id="div_lst_creditos" style="width:100%;height:100%;overflow:auto">      
              <table class="tb1 highlightEven highlightTROver" id="tbDetalle">
                        <xsl:apply-templates select="xml/rs:data/z:row" />
                      </table>
              </div>
              <div id="tbPages">
                <script type="text/javascript">
                  document.write(campos_head.paginas_precarga_getHTML())
                </script>
              </div>
            </body>
        </html>
    </xsl:template>

    <xsl:template match="z:row">
        <xsl:variable name="pos" select="position()"/>
        <tr>
            <xsl:if test="@estado = 'R'">
              <xsl:attribute name="style">color:red</xsl:attribute>          
            </xsl:if>            
            <xsl:attribute name="id">tr_ver<xsl:value-of select="$pos"/></xsl:attribute>
         <td style="text-align: center; width: 25px;cursor:hand">
         <xsl:attribute name="onclick">MostrarCredito('<xsl:value-of select="@nro_credito"/>')</xsl:attribute>
            <img class="img_button_sel" src="../../precarga/image/search_32.png" border="0" title="Ver crédito"></img>
            <!--<xsl:choose>
              <xsl:when test="@estado = 'M' or @estado = 'H'">
                <img class="img_button_sel" style='cursor:hand' src="../../precarga/image/search_32.png" border="0" title="Ver crédito">
                  <xsl:attribute name="onclick">
                    MostrarCredito('<xsl:value-of select="@nro_credito"/>')
                  </xsl:attribute>
                </img>
              </xsl:when>
              <xsl:when test="@estado = 'H'">
                <img class="img_button" style='cursor:hand' src="../../precarga/image/search_24.png" border="0" title="Anular Solicitud">
                  <xsl:attribute name="onclick">
                    Acciones('<xsl:value-of select="@nro_credito"/>','M')
                  </xsl:attribute>
                </img>
              </xsl:when>
            </xsl:choose>-->
          </td>
              <td style="text-align: center;width:20%;cursor:hand">
                <xsl:attribute name="onclick">MostrarCredito('<xsl:value-of select="@nro_credito"/>')</xsl:attribute>
                <a>
                  <xsl:attribute name='style'>text-decoration:underline;cursor:pointer;font-weight:bold;color: #000000 !important</xsl:attribute>
                  <xsl:value-of  select="format-number(@nro_credito,'0000000')" />
                </a>
              </td>
              <td style='text-align: left;width:35%' rowspan='true'>
                <xsl:value-of  select="@strNombreCompleto" />
              </td>
              <td style='text-align: left;width:35%' rowspan='true'>
                <xsl:value-of  select="@descripcion" /> - <xsl:value-of select="@fe_estado_str"/>
              </td>                          
        </tr>
    </xsl:template>
</xsl:stylesheet>
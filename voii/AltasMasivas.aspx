<%@ Page Language="VB" AutoEventWireup="false" Inherits="nvFW.nvPages.nvPageVOII" %>

<%

    Dim err As New terror

    Try

        Dim sql As String = " select  distinct e.tipocli, e.tiporel, e.tipdoc,e.tipdoc_desc, e.nrodoc, e.CUIT_CUIL, e.DNI, e.cliape, e.clinom, e.clinom,null as clideno, null as email," & vbCrLf &
                            "convert(varchar(20),e.fecnac_insc,103) As fecnac_insc, e.clisexo, null as cartel, null as numtel, e.razon_social, e.tipreldesc, null as domnom, null as domnro, null as dompiso," & vbCrLf &
                            "null as domdepto, null as codpos, null as loccoddesc, null as codprovdesc,null as policaexpuesto " & vbCrLf &
                            "from tmp_ar_legajos l" & vbCrLf &
                            "join [tmp_clientes_ibs] e on e.nrodoc = l.cuit " & vbCrLf &
                            "join [tmp_ar_cab] tc on tc.codigo = l.codigo" & vbCrLf &
                            "join tmp_ar_det td on td.codigo = l.documento" & vbCrLf &
                            "join archivos_def_cab c on c.def_archivo = tc.descripcion " & vbCrLf &
                            "left outer join archivo_leg_cab leg on leg.id_tipo = e.nro_entidad And leg.nro_archivo_id_tipo = 2" & vbCrLf &
                            "where leg.id_tipo is null and" & vbCrLf &
                            "  l.cuit in (30710666039,30639453738,30708807318,30716090333,30716046555,30681118892,30710604246,30708737328,30707505032,33688365339,30999264529,30518849634,30690473018,30709635480,30708307234,30682509550,30707636544,30677240047,30716454963,30500092242,30555789692,30651549600,30716066807,30715832816,30649280726,30714629316,30711610126,10000,30681490465,30709380679,30707227415,30701016129,30712331239,30576614299,30517637498,30604731018,30500010602,30671375900,30500001735,30500010912,33999242109,30500009442,30704960995,30518954241,30500011072,30685029959,30580189411,30516420444,30500006613,30569151763,30500008454,33500005179,30500005862,30500003193,30584727566,30573652084,30502786594,30500005625,30655723532,30604733169,30663148776,30501290323,30693792335,30628446950,30714219282,30655725829,30708107391,33537186009,30709447846,30500055509,30714369098,33680832299,30529278566,30630170210,30641480092,30638731750,30682737650,30999011728,30590203439,30659379011,33707995519,30692432661,30670157799,30684361917,30701027074,30714808504,30500049460,30708122773,30666408485,30707373438,30701009548,30708329122,30999228565,30691587777,30576721710,30500987878,30661873678,30688331761,30628284357,30686273330,33637617449,30656296840,30500017704,30707247408,30500036911,30685843400,30526297217,33708163959,30539222259,30709506281,30709199966,30712051848,30712101136,30707969659,30710431309,30500010084,1111,111111111,30500055746,30624421899,30679921912,30710859376,30500032886,30682408622,30709803804,30576124275,30554475910,11112,33999181819,30500014047,30517948205,30715044982,30677269940,30651129083,30678774703,33709965579,30594950913,30585058781,30538029439,30710198388,30710630670,30616836869,30608298815,30711943982,30500012990,30500012516,30678806230,30999032083,30697265410,30712241450,30558543317,30712592407,30534487491,30540618263,30710222858,30654231016,30529246427,30657862068,30714522058,30660515980,30710410077,30500098801,30707810978,30677937560,30671859339,654,30693764943,30714195960,30708537272,30619740854,30542033637,33710717309,30540396678,30500781293,33572266449,30657441216,30708896434,30711653135,30711596603,30712452338,30712137793,30708710098,30715054619,30534672434,30522714417,30593174057,30708348070,30714202789,717,30682434720,33715162089,30710911580,30500056661,30709979686,30709042064,30678158506,30711425728,30620608730,30678158433,30714590363,30657515503,30714972630,30655808465,30715499564,30685227440,30605951518,30660281386,30708594802,30715798200,30680790805,30711425086,30708270292,30611995128,30710019572,30650254755,33693710559,30712126457,33707610579,30546826321,30707032533,33715997199,33707784429,30716098687,30574868730,30699998008,30615726547,30538006404,30707971831,33708285809,30715403435,30715046012,30710384564,30641487267,30710107528,30683061537,30699990848,33710657969,30693503953,30710096852,30693504186,33715382259,30672394011,30715315889,30709793485,30712390316,30674599885,30707799087,30716490137,30716503077,30716245558,30716140977,30714773263,30714467626,30714572691,33714651809,30714861375,30710203144,30714958824,30715068261,30715127411,30715198866,30715566296,30714008281,33715292659,30715420844,30715664344,30715718185,30715813978,30715884492,30715927817,30716068486,30716142945,30710090471,30716258692,33716315199,690,1099,695,1106,1061,1022,845,688,670,571,572,687,686,756,121,186,319,162,659,145,524,586,588,664,640,631,123,700,769,11111111111,768,770,707,62,158,429,373,154,590,422,567,562,671,628,108,508,712,244,106,107,437,615,583,616,693,653,120,270,681,737,667,715,514,585,111,745,796,779,781,682,794,738,734,795,685,629,672,673,578,642,598,740,515,720,655,711,723,743,680,832,776,809,775,774,787,568,808,637,636,724,754,469,824,834,601,612,846,668,1029,466,1028,517,518,982,52,784,819,907,1018,852,1007,1006,30692335623,30709733385,30699555386,33708713959,30693664175,30543696168,30707807128,30709579467,30597132413,30711206953,30545111302,30581096743,34500045339,30623026902,30709228419,11111,30571421352,30615807415,30682713700,30672418735,30545819089,30646367790,30701280802,30707594140,30714094226,30678562846,30678706228,30710153619,30711129401,30605659981,33711915759,30704978878,30688992008,20116777003,27226200016,20076054305,27131735664,20322618213,20348278216,20298341523,20258036280,20105253460,20173678186,20126761377,20141262603,20223831053,20061512102,27255980012,20168294884,27179801944,20353227182,20125301453,20132960144,20254000737,27119858300,20921931914,20168270942,20085503929,20186807546,20177617211,20129023237,20083543826,20225336971,20202517839,10115,27101308907,20076981486,20144553315,20149902830,20127728594,20083998866,20244295917,20121376769,20217557322,20234049837,27244597195,27264356054,23238042194,20118894856,27222519328,20206105659,27315307118,20255203631,27289626374,27169768620,27134167608,23304773804,20283620531,23229908499,20358624228,20291903720,27231751721,27251089707,20143915302,23204203644,23165879619,23178999494,20377337744,20308626971,20215884822,27129529364,27348136076,27160178693,20148202282,23307435624,20925832872,27044733752,27064393869,23131801114,27249219504,27222509152,20076817597,27062784372,27203120171,20287119292,20182721140,23117031489,20313935818,27947195110,20172554963,20355514898,27116924434,20045384749,20204062146,20042981339,27223632632,23180187154,27309979864,23335105109,27233729693,27304957609,27293189671,27037356781,20184366755,27183040184,20062644436,27385338207,20235722535,2724047007,20298342538,20294587749,20178066847,27263436240,20167651764,20160620340,20062509156,27039590013,23242149114,20218329951,23082656669,20311448642,20224569581,20238877114,20266316691,20229556879,23181786019,20249247538,20116525764,20044231590,20175761927,23226517529,2017084487,20310553523,20170844875,27241559683,23076751579,20147182075,23239870414,23106629064,20060694940,20172362282,20258054807,27179105166,27180395038,20084411664,20228656470,20251579335,27234880050,20146897151,20043089952,20104621776,27232507727,20049835753,20174364150,20209762472,25271811390,23928504964,20208423321,20272021059,20221515979,20174235776,2005206141,20233766357,20210723839,20298962013,23206918489,27205372348,20246553956,27221757268,20230394815,20123319177,20280579131,20219548975,20266973641,23249438154,20228476928,27247738040,20271135255,20248735377,20243404097,20297800166,20324387995,20242706731,20133050222,27240281150,20050649505,20161315657,23344349339,27134118771,20312063760,20110767626,20161688550,20172335242,27100286179,2016948579,20233089096,20165159145,20109299686,20213002822,20239872019,27118379123,20109669440,1,20060145106,20060464171,20114476227,20210034855,27136158231,20184020905,23177372889,20304357976,20044320208,20084623246,20164903436,20041951606,20062429764,27105248518,20143974007,27238195654,27173399834,27226740738,27180432944,20182631680,20118367066,27242497029,27281584524,20137085055,20228246973,27148098730,20127088935,20139789866,20110223375,20147551496,27263537500,20119961158,232430334779,20205737368,25670202,20115065700,20047516812,20244487816,20223023186,27259968416,20950458950,20204104876,20224113456,20045328589,20254303462,27921868990,20148201723,20235677122,27228474970,20223492623,23165126009,20222734550,200840690363,23300757529,20161817830,27165501190,20137612411,23214235854,20129753235,20276249607,27292319180,20060353930,20172866272,20059889479,20043758544,20105578106,20131695714,20147042877,27127271998,23127203059,23141574159,27109958501,20209461170,20104634940,20119874263,20934813872,20229752937,27135308892,20178198883,20145101000,20216532989,20147010487,27214898786,20220992900,20239682961,20142223776,27180700507,27268739845,23227810394,20220332048,20224325437,20239914986,20167855386,20601908574,20149980548,20149271148,20237383452,20136314182,20169485799,27210936276,20342548718,20219305711,27134429238,20137476410,20118992602,20224706805,20265927719,20219472472,23247026959,20145295190,20204859044,20164922392,20134864193,20114598888,27185293268,23271197934,20181740478,20103299633,20133668242,20149128795,23041964529,20063008770,20954222781,72854,20185816819,27205429803,20149074652,20255672933,20205361430,27211419453,20144411715,20177268497,20226214012,23204785139,20146180877,20270321705,23079617989,20302190586,20048168265,23279407809,20174243811,20247171747,20254311279,27229627665,23134302569,20141563506,20053632980,20108252236,20113339714,20227504537,20235685745,20284634188,27238651854,27138076658,20163351464,20166731535,20114598730,20171430586,20161461017,23182628379,20177076199,23224105134,20132112259,27149518474,23146189644,20289907360,27276428476,20257453708,20232049880,20258657196,20240174635,23236700909,27302779312,20233723496,23357298814,27181515681,27317828662,20044152348,27178334447,20122769438,20043134656,27312841261,23085284649,20140201554,20101237673,20315410461,27341500821,20326382524,27301433927,20165595875,20073772401,20179469007,27284010103,23243038979,20171086575,20235722861,23083878819,20124916373,20134179407,20178811666,23261528274,23311962639,20241710050,20126397292,20132455512,20233550206,20304261006,20137822629,20345361538,20129804557,20129320665,23249920339,23123187709,23165764269,20170033532,23110502419,20102491867,20316461728,27342867486,27277701230,20082098624,20134177595,27101416297,20939518127,27237804630,27296556985,20228845222,20119866996,20043992407,20145877742,20258037732,20119870502,27322188523,20249333116,20148480622,20105087897,20174756970,27254661150,20171727554,20219387874,27941008343,27123657360,23238332419,20171291365,20144057113,27141874492,20940769656,20140562700,20276741102,20234681126,20265363602,27275457324,20140150623,20294492535,20235108195,20181067595,20055302651,20117847587,23165434919,27216436100,20953278821,20207348954,20263529570,20202981314,20233173283,23243652219,20272881554,20166261369,20231267531,20280329275,20129453282,20134700581,20127130796,20126046805,20085497880,20178096940,20140989623,20123861036,20226751182,20116246156,27132772008,27247281113,20164960448,20043058461,20111201197,20164304680,20173591196,20077849204,20254314561,20216132506,20077963392,20134959372,20122483593,20218514252,20244981357,20225506419,23129766719,20145851530,20203553286,20177822907,27173252590,20238800286,20085732464,20140264920,20243780269,20180234862,20122856128,20044370825,23114789399,27925828187,23122381099,23135264539,20135016102,27172544520,20076653594,20252887653,20255461185,27122637056,27185153822,27127298713,20136579933,20145268746,20226280325,27258633372,20179450101,20171006458,20254330990,20173825839,27251274512,20219228903,20288948977,20214399343,20226062972,20181604825,27226537827,20119855153,23120838539,20302557781,20276883527,24214465694,27332429251,27293138333,20214751136,20130580522,20223494022,20260962184,20200169132,20209881870,20235075580,20139744951,27188554941,23188397239,20122856357,20223679928,23142220539,20112107933,20119117756,20223444653,27122774010,27136552967,20175416081,20043045394,20285075580,20118978790,27229790337,20112667602,20221262108,20059213297,20223669124,20183623487,20217102260,20221103018,20323576808,20085535820,27273871719,27185528095,27238781839,20947470435,20382528876,20306122164,27294799740,20226356828,23250208014,20231833030,20253177609,27224934713,20233723186,27299867698,20202507973,27264736345,23161052779,20119878986,20279496761,20142227275,20341461910,27163622691,20131873213,27054651134,20133991345,20165697430,23281671499,20280307077,20242545029,20214384974,27117275308,20140125416,20218517316,20172876553,27118747726,20314388926,20167117504,20136239466,20262814042,20228260194,27128406528,20084069036,20286941029,20252968041,20240617693,20293873659,27124852205,20316603417,27234730784,20261341515,20161441881,20127285943,23202263844,20179998433,20137542634,20211520087,20112042890,23326412589,27307115668,27132305299,20255180860,20118204043,20232737817,27200279196,27171696424,27064107769,20214916712,20239656731,20284677359,23228571474,20172331883,20129986388,20050692451,23260444999,20256700221,20102786182,20284213794,15287582,27236111283,20940983267,23250205759,20184146968,27206205569,20078695464,20280766640,23236691349,20121241111,20101106536,20107436600,20244966226,20220229484,23231144854,20354004004,20249096114,20147618132,20225889695,20237314914,27228353677,27051345873,20379964037,27176866190,20049540503,20249571211,23825554819,20213576659,20106215643,20076085936,20118151047,27167933667,27304489672,27223294982,20045368816,27065532331,23325554819,24332957496,20217102198,20224198478,20045444865,20308154190,27340567612,24346303790,20295912376,20284904584,23121050099,20082363530,27245994651,23235703459,20271876840,20287302151,20187807795,23166262089,23235336529,20253765322,20138011756,20118758324,27321877120,27138553138,27267350901,27173645924,20129461080,27188463512,27236853395,20250961902,27937094383,27343744949,20245032189,23297760114,20165212712,23202885209,23242560299,20250395087,20246623733,27254802323,27219053555,27276221618,27168800385,20219193158,20282339251,20248231891,20275447707,20168345311,20162079345,20178670183,20284712952,20164283691,20168916400,20232767007,27941243954,20176486865,20179329353,27166481851,20295204681,27284967653,27202347938,20234731204,23184909189,20261205751,20232283573,20149777920,20262010075,20100853125,20173637188,20078385589,27143397675,23147605439,220128820893,20138393748,20128820893,20133052861,27252843952,23244967672,20110617381,20147437626,23312586649,23264563739,20386858676,20252489410,20222519838,27163351868,20084144380,20184146089,20113627434,20229632567,27063741294,20289194038,27242713880,27181421067,20124532117,20344364134,20285088489,23162468979,20083899876,23051201914,20283141232,20041604000,20164876072,20257881475,20320513961,20307436192,23075210299,27163226753,20340981155,20261653959,20312271126,20173320974,20148731072,20175351931,20123516150,20137594250,20085081013,27140332432,23222296064,27307083626,20169101540,20133805614,20101389244,23084102059,20182677966,20049628391,20308341721,20244967672,27046681318,20217234965,27128523818,27174115015,20270268251,20201962243,20251885908,20258956088,20115941667,27294800986,20228261182,20103998116,20315769311,20359924748,23186402359,20242325622,20149980173,20236263666,20045940803,20250151994,20102017030,20178367006,27274642322,20169751154) "

        Dim rs As ADODB.Recordset = nvFW.nvDBUtiles.DBOpenRecordset(sql)
        While rs.EOF = False

            Dim razon_social As String = ""
            'consultar que no exista en la tabla de compatibilidad
            Dim rsComp As ADODB.Recordset = nvFW.nvDBUtiles.DBOpenRecordset("Select nro_entidad, tipdoc, nrodoc from verEntidades_compatibilidad_ibs where tipdoc = " & rs.Fields("tipdoc").Value & " And nrodoc = " & rs.Fields("nrodoc").Value)
            If rsComp.EOF = True Then

                Dim rsNomenclado As ADODB.Recordset = nvFW.nvDBUtiles.DBOpenRecordset("Select cod_interno, cod_externo from nv_codigos_externos where sistema_externo='ibs' and elemento='documento' and cod_externo='" & rs.Fields("tipdoc").Value & "'")
                Dim tipdoc As String = rsNomenclado.Fields("cod_interno").Value.ToString
                nvFW.nvDBUtiles.DBCloseRecordset(rsNomenclado)

                razon_social = "<![CDATA[" & rs.Fields("razon_social").Value.ToString & "]]>"
                Dim abreviacion As String = "<![CDATA[" & rs.Fields("razon_social").Value.ToString & "]]>"
                Dim apellido As String = "<![CDATA[" & rs.Fields("cliape").Value.ToString & "]]>"
                Dim nombres As String = "<![CDATA[" & rs.Fields("clinom").Value.ToString & "]]>"


                Dim _alias As String = IIf(IsDBNull(rs.Fields("clideno").Value) = False, "<![CDATA[" & rs.Fields("clideno").Value.ToString & "]]>", "")
                Dim calle As String = "<![CDATA[" & rs.Fields("domnom").Value.ToString & "]]>"
                Dim email As String = "<![CDATA[" & rs.Fields("email").Value.ToString & "]]>"
                Dim esPersona_fisica As Boolean = IIf(rs.Fields("tipocli").Value = "1", True, False)

                Dim xmldato As String = "<?xml version=""1.0"" encoding=""ISO-8859-1""?>"
                xmldato += "<pago_entidad modo='AC' nro_entidad='' "
                If rs.Fields("cartel").Value.ToString <> "" Then
                    xmldato += "postal_telefono='" & IIf(IsDBNull(rs.Fields("cartel").Value) = True, rs.Fields("cartel").Value.ToString, "") & "' "
                End If

                If IsDBNull(rs.Fields("numtel").Value) = False Then
                    xmldato += "telefono='" & IIf(IsDBNull(rs.Fields("numtel").Value) = True, rs.Fields("numtel").Value.ToString, "") & "' "
                End If

                xmldato += "cuit='" & rs.Fields("CUIT_CUIL").Value.ToString & "' "
                xmldato += "cuitcuil='" & IIf(IsDBNull(esPersona_fisica) = True, "CUIL", "CUIT") & "' "
                xmldato += "numero='" & rs.Fields("domnro").Value.ToString & "' nro_contacto_tipo='1' resto='' "
                If IsDBNull(rs.Fields("dompiso").Value) = False Then
                    xmldato += "piso='" & rs.Fields("dompiso").Value.ToString & "' "
                    If IsDBNull(rs.Fields("domdepto").Value) = False Then
                        xmldato += "depto='" & rs.Fields("domdepto").Value.ToString & "' "
                    End If

                End If

                If IsDBNull(rs.Fields("policaexpuesto").Value) = False Then
                    If rs.Fields("policaexpuesto").Value = 1 Then
                        xmldato += "pep='1' "
                    Else
                        xmldato += "pep='0' "
                    End If
                End If

                Dim fecnac_insc As String = IIf(IsDBNull(rs.Fields("fecnac_insc").Value) = True, "", rs.Fields("fecnac_insc").Value)

                If esPersona_fisica Then
                    xmldato += "nro_docu='" & rs.Fields("nrodoc").Value.ToString & "' tipo_docu='" & tipdoc & "' sexo='" & rs.Fields("clisexo").Value.ToString & "' persona_fisica='1' "
                    xmldato += "dni='" & rs.Fields("DNI").Value.ToString & "' nro_emp_tipo='' nro_soc_tipo='' "
                    xmldato += "fecha_nacimiento='" & fecnac_insc.ToString & "' fecha_inscripcion='' "
                Else
                    xmldato += "nro_docu='" & rs.Fields("nrodoc").Value.ToString & "' tipo_docu='" & tipdoc.ToString & "' sexo='' persona_fisica='0' "
                    xmldato += "dni='' nro_emp_tipo='' nro_soc_tipo='' "
                    xmldato += "fecha_nacimiento='' fecha_inscripcion='" & fecnac_insc.ToString & "' estado_civil='' nro_nacion='' "
                End If

                xmldato += ">"

                If esPersona_fisica = True Then
                    xmldato += "<apellido>" & apellido & "</apellido>"
                    xmldato += "<nombres>" & nombres & "</nombres>"
                Else
                    xmldato += "<apellido></apellido>"
                    xmldato += "<nombres></nombres>"
                End If

                xmldato += "<razon_social>" & razon_social & "</razon_social>"
                xmldato += "<abreviacion>" & abreviacion & "</abreviacion>"
                xmldato += "<alias>" & _alias & "</alias>"
                xmldato += "<calle>" & calle & "</calle>"
                xmldato += "<email>" & email & "</email>"
                xmldato += "</pago_entidad>"

                'nvServer.Events.RaiseEvent("entidad_onSave", "", xmldato)

                ' Dim Err As New nvFW.tError()

                Try
                    Dim cmd As New nvFW.nvDBUtiles.tnvDBCommand("nv_entidad_abm", ADODB.CommandTypeEnum.adCmdStoredProc, nvDBUtiles.emunDBType.db_app)
                    cmd.addParameter("@strXML", ADODB.DataTypeEnum.adLongVarChar, ADODB.ParameterDirectionEnum.adParamInput, xmldato.Length, xmldato)

                    rs = cmd.Execute()

                    Dim nro_entidad As String = rs.Fields("nro_entidad").Value
                    'Err.numError = rs.Fields("numError").Value
                    'Err.titulo = rs.Fields("titulo").Value
                    'Err.mensaje = rs.Fields("mensaje").Value
                    'Err.params.Add("nro_entidad", nro_entidad)

                    If rs.Fields("numError").Value <> 0 Then
                        Dim msgEvent As String = "Error de inserción en Nova - Mensaje: " & rs.Fields("mensaje").Value

                        nvFW.nvLog.addEvent("IBS_entidad_save_error", msgEvent)
                    Else
                        Dim msgEvent As String = "Inserción correcta en Nova - Nro. Entidad: " & rs.Fields("nro_entidad").Value

                        nvFW.nvLog.addEvent("IBS_entidad_save", msgEvent)
                    End If

                Catch ex As Exception
                    Dim msgEvent As String = "Error de inserción en Nova"

                    nvFW.nvLog.addEvent("IBS_entidad_save_error", msgEvent)
                End Try

            End If

            rs.MoveNext()
        End While

        Dim strSQL As String = " select  e.nro_entidad,leg.nro_archivo_id_tipo,d.nro_def_detalle" & vbCrLf &
                               ",convert(varchar(50),case when [fecha presentacion] is null then getdate() else [fecha presentacion] end,103) as fe_alta" & vbCrLf &
                               ",convert(varchar(50),case when [fecha vencimiento] is null then null else [fecha vencimiento] end,103)  as fe_venc" & vbCrLf &
                               "from tmp_ar_legajos l" & vbCrLf &
                               "inner join [tmp_clientes_ibs] e on e.nrodoc = l.cuit " & vbCrLf &
                               "inner join verEntidades_compatibilidad_ibs ve on ve.nro_entidad = e.nro_entidad" & vbCrLf &
                               "inner join [tmp_ar_cab] tc on tc.codigo = l.codigo" & vbCrLf &
                               "inner join tmp_ar_det td on td.codigo = l.documento" & vbCrLf &
                               "inner join archivos_def_cab c on c.def_archivo = tc.descripcion " & vbCrLf &
                               "inner join archivos_def_detalle d on d.archivo_descripcion = td.documento And c.nro_def_archivo = d.nro_def_archivo " & vbCrLf &
                               "inner join archivo_leg_cab leg on leg.id_tipo = e.nro_entidad And leg.nro_archivo_id_tipo = 2" & vbCrLf &
                               "left outer join archivos a on a.nro_def_detalle = d.nro_def_detalle And leg.id_tipo = a.id_tipo And a.nro_archivo_id_tipo = leg.nro_archivo_id_tipo And nro_archivo_estado in (1,3)" & vbCrLf &
                               "where l.cuit in (30710666039,30639453738,30708807318,30716090333,30716046555,30681118892,30710604246,30708737328,30707505032,33688365339,30999264529,30518849634,30690473018,30709635480,30708307234,30682509550,30707636544,30677240047,30716454963,30500092242,30555789692,30651549600,30716066807,30715832816,30649280726,30714629316,30711610126,10000,30681490465,30709380679,30707227415,30701016129,30712331239,30576614299,30517637498,30604731018,30500010602,30671375900,30500001735,30500010912,33999242109,30500009442,30704960995,30518954241,30500011072,30685029959,30580189411,30516420444,30500006613,30569151763,30500008454,33500005179,30500005862,30500003193,30584727566,30573652084,30502786594,30500005625,30655723532,30604733169,30663148776,30501290323,30693792335,30628446950,30714219282,30655725829,30708107391,33537186009,30709447846,30500055509,30714369098,33680832299,30529278566,30630170210,30641480092,30638731750,30682737650,30999011728,30590203439,30659379011,33707995519,30692432661,30670157799,30684361917,30701027074,30714808504,30500049460,30708122773,30666408485,30707373438,30701009548,30708329122,30999228565,30691587777,30576721710,30500987878,30661873678,30688331761,30628284357,30686273330,33637617449,30656296840,30500017704,30707247408,30500036911,30685843400,30526297217,33708163959,30539222259,30709506281,30709199966,30712051848,30712101136,30707969659,30710431309,30500010084,1111,111111111,30500055746,30624421899,30679921912,30710859376,30500032886,30682408622,30709803804,30576124275,30554475910,11112,33999181819,30500014047,30517948205,30715044982,30677269940,30651129083,30678774703,33709965579,30594950913,30585058781,30538029439,30710198388,30710630670,30616836869,30608298815,30711943982,30500012990,30500012516,30678806230,30999032083,30697265410,30712241450,30558543317,30712592407,30534487491,30540618263,30710222858,30654231016,30529246427,30657862068,30714522058,30660515980,30710410077,30500098801,30707810978,30677937560,30671859339,654,30693764943,30714195960,30708537272,30619740854,30542033637,33710717309,30540396678,30500781293,33572266449,30657441216,30708896434,30711653135,30711596603,30712452338,30712137793,30708710098,30715054619,30534672434,30522714417,30593174057,30708348070,30714202789,717,30682434720,33715162089,30710911580,30500056661,30709979686,30709042064,30678158506,30711425728,30620608730,30678158433,30714590363,30657515503,30714972630,30655808465,30715499564,30685227440,30605951518,30660281386,30708594802,30715798200,30680790805,30711425086,30708270292,30611995128,30710019572,30650254755,33693710559,30712126457,33707610579,30546826321,30707032533,33715997199,33707784429,30716098687,30574868730,30699998008,30615726547,30538006404,30707971831,33708285809,30715403435,30715046012,30710384564,30641487267,30710107528,30683061537,30699990848,33710657969,30693503953,30710096852,30693504186,33715382259,30672394011,30715315889,30709793485,30712390316,30674599885,30707799087,30716490137,30716503077,30716245558,30716140977,30714773263,30714467626,30714572691,33714651809,30714861375,30710203144,30714958824,30715068261,30715127411,30715198866,30715566296,30714008281,33715292659,30715420844,30715664344,30715718185,30715813978,30715884492,30715927817,30716068486,30716142945,30710090471,30716258692,33716315199,690,1099,695,1106,1061,1022,845,688,670,571,572,687,686,756,121,186,319,162,659,145,524,586,588,664,640,631,123,700,769,11111111111,768,770,707,62,158,429,373,154,590,422,567,562,671,628,108,508,712,244,106,107,437,615,583,616,693,653,120,270,681,737,667,715,514,585,111,745,796,779,781,682,794,738,734,795,685,629,672,673,578,642,598,740,515,720,655,711,723,743,680,832,776,809,775,774,787,568,808,637,636,724,754,469,824,834,601,612,846,668,1029,466,1028,517,518,982,52,784,819,907,1018,852,1007,1006,30692335623,30709733385,30699555386,33708713959,30693664175,30543696168,30707807128,30709579467,30597132413,30711206953,30545111302,30581096743,34500045339,30623026902,30709228419,11111,30571421352,30615807415,30682713700,30672418735,30545819089,30646367790,30701280802,30707594140,30714094226,30678562846,30678706228,30710153619,30711129401,30605659981,33711915759,30704978878,30688992008,20116777003,27226200016,20076054305,27131735664,20322618213,20348278216,20298341523,20258036280,20105253460,20173678186,20126761377,20141262603,20223831053,20061512102,27255980012,20168294884,27179801944,20353227182,20125301453,20132960144,20254000737,27119858300,20921931914,20168270942,20085503929,20186807546,20177617211,20129023237,20083543826,20225336971,20202517839,10115,27101308907,20076981486,20144553315,20149902830,20127728594,20083998866,20244295917,20121376769,20217557322,20234049837,27244597195,27264356054,23238042194,20118894856,27222519328,20206105659,27315307118,20255203631,27289626374,27169768620,27134167608,23304773804,20283620531,23229908499,20358624228,20291903720,27231751721,27251089707,20143915302,23204203644,23165879619,23178999494,20377337744,20308626971,20215884822,27129529364,27348136076,27160178693,20148202282,23307435624,20925832872,27044733752,27064393869,23131801114,27249219504,27222509152,20076817597,27062784372,27203120171,20287119292,20182721140,23117031489,20313935818,27947195110,20172554963,20355514898,27116924434,20045384749,20204062146,20042981339,27223632632,23180187154,27309979864,23335105109,27233729693,27304957609,27293189671,27037356781,20184366755,27183040184,20062644436,27385338207,20235722535,2724047007,20298342538,20294587749,20178066847,27263436240,20167651764,20160620340,20062509156,27039590013,23242149114,20218329951,23082656669,20311448642,20224569581,20238877114,20266316691,20229556879,23181786019,20249247538,20116525764,20044231590,20175761927,23226517529,2017084487,20310553523,20170844875,27241559683,23076751579,20147182075,23239870414,23106629064,20060694940,20172362282,20258054807,27179105166,27180395038,20084411664,20228656470,20251579335,27234880050,20146897151,20043089952,20104621776,27232507727,20049835753,20174364150,20209762472,25271811390,23928504964,20208423321,20272021059,20221515979,20174235776,2005206141,20233766357,20210723839,20298962013,23206918489,27205372348,20246553956,27221757268,20230394815,20123319177,20280579131,20219548975,20266973641,23249438154,20228476928,27247738040,20271135255,20248735377,20243404097,20297800166,20324387995,20242706731,20133050222,27240281150,20050649505,20161315657,23344349339,27134118771,20312063760,20110767626,20161688550,20172335242,27100286179,2016948579,20233089096,20165159145,20109299686,20213002822,20239872019,27118379123,20109669440,1,20060145106,20060464171,20114476227,20210034855,27136158231,20184020905,23177372889,20304357976,20044320208,20084623246,20164903436,20041951606,20062429764,27105248518,20143974007,27238195654,27173399834,27226740738,27180432944,20182631680,20118367066,27242497029,27281584524,20137085055,20228246973,27148098730,20127088935,20139789866,20110223375,20147551496,27263537500,20119961158,232430334779,20205737368,25670202,20115065700,20047516812,20244487816,20223023186,27259968416,20950458950,20204104876,20224113456,20045328589,20254303462,27921868990,20148201723,20235677122,27228474970,20223492623,23165126009,20222734550,200840690363,23300757529,20161817830,27165501190,20137612411,23214235854,20129753235,20276249607,27292319180,20060353930,20172866272,20059889479,20043758544,20105578106,20131695714,20147042877,27127271998,23127203059,23141574159,27109958501,20209461170,20104634940,20119874263,20934813872,20229752937,27135308892,20178198883,20145101000,20216532989,20147010487,27214898786,20220992900,20239682961,20142223776,27180700507,27268739845,23227810394,20220332048,20224325437,20239914986,20167855386,20601908574,20149980548,20149271148,20237383452,20136314182,20169485799,27210936276,20342548718,20219305711,27134429238,20137476410,20118992602,20224706805,20265927719,20219472472,23247026959,20145295190,20204859044,20164922392,20134864193,20114598888,27185293268,23271197934,20181740478,20103299633,20133668242,20149128795,23041964529,20063008770,20954222781,72854,20185816819,27205429803,20149074652,20255672933,20205361430,27211419453,20144411715,20177268497,20226214012,23204785139,20146180877,20270321705,23079617989,20302190586,20048168265,23279407809,20174243811,20247171747,20254311279,27229627665,23134302569,20141563506,20053632980,20108252236,20113339714,20227504537,20235685745,20284634188,27238651854,27138076658,20163351464,20166731535,20114598730,20171430586,20161461017,23182628379,20177076199,23224105134,20132112259,27149518474,23146189644,20289907360,27276428476,20257453708,20232049880,20258657196,20240174635,23236700909,27302779312,20233723496,23357298814,27181515681,27317828662,20044152348,27178334447,20122769438,20043134656,27312841261,23085284649,20140201554,20101237673,20315410461,27341500821,20326382524,27301433927,20165595875,20073772401,20179469007,27284010103,23243038979,20171086575,20235722861,23083878819,20124916373,20134179407,20178811666,23261528274,23311962639,20241710050,20126397292,20132455512,20233550206,20304261006,20137822629,20345361538,20129804557,20129320665,23249920339,23123187709,23165764269,20170033532,23110502419,20102491867,20316461728,27342867486,27277701230,20082098624,20134177595,27101416297,20939518127,27237804630,27296556985,20228845222,20119866996,20043992407,20145877742,20258037732,20119870502,27322188523,20249333116,20148480622,20105087897,20174756970,27254661150,20171727554,20219387874,27941008343,27123657360,23238332419,20171291365,20144057113,27141874492,20940769656,20140562700,20276741102,20234681126,20265363602,27275457324,20140150623,20294492535,20235108195,20181067595,20055302651,20117847587,23165434919,27216436100,20953278821,20207348954,20263529570,20202981314,20233173283,23243652219,20272881554,20166261369,20231267531,20280329275,20129453282,20134700581,20127130796,20126046805,20085497880,20178096940,20140989623,20123861036,20226751182,20116246156,27132772008,27247281113,20164960448,20043058461,20111201197,20164304680,20173591196,20077849204,20254314561,20216132506,20077963392,20134959372,20122483593,20218514252,20244981357,20225506419,23129766719,20145851530,20203553286,20177822907,27173252590,20238800286,20085732464,20140264920,20243780269,20180234862,20122856128,20044370825,23114789399,27925828187,23122381099,23135264539,20135016102,27172544520,20076653594,20252887653,20255461185,27122637056,27185153822,27127298713,20136579933,20145268746,20226280325,27258633372,20179450101,20171006458,20254330990,20173825839,27251274512,20219228903,20288948977,20214399343,20226062972,20181604825,27226537827,20119855153,23120838539,20302557781,20276883527,24214465694,27332429251,27293138333,20214751136,20130580522,20223494022,20260962184,20200169132,20209881870,20235075580,20139744951,27188554941,23188397239,20122856357,20223679928,23142220539,20112107933,20119117756,20223444653,27122774010,27136552967,20175416081,20043045394,20285075580,20118978790,27229790337,20112667602,20221262108,20059213297,20223669124,20183623487,20217102260,20221103018,20323576808,20085535820,27273871719,27185528095,27238781839,20947470435,20382528876,20306122164,27294799740,20226356828,23250208014,20231833030,20253177609,27224934713,20233723186,27299867698,20202507973,27264736345,23161052779,20119878986,20279496761,20142227275,20341461910,27163622691,20131873213,27054651134,20133991345,20165697430,23281671499,20280307077,20242545029,20214384974,27117275308,20140125416,20218517316,20172876553,27118747726,20314388926,20167117504,20136239466,20262814042,20228260194,27128406528,20084069036,20286941029,20252968041,20240617693,20293873659,27124852205,20316603417,27234730784,20261341515,20161441881,20127285943,23202263844,20179998433,20137542634,20211520087,20112042890,23326412589,27307115668,27132305299,20255180860,20118204043,20232737817,27200279196,27171696424,27064107769,20214916712,20239656731,20284677359,23228571474,20172331883,20129986388,20050692451,23260444999,20256700221,20102786182,20284213794,15287582,27236111283,20940983267,23250205759,20184146968,27206205569,20078695464,20280766640,23236691349,20121241111,20101106536,20107436600,20244966226,20220229484,23231144854,20354004004,20249096114,20147618132,20225889695,20237314914,27228353677,27051345873,20379964037,27176866190,20049540503,20249571211,23825554819,20213576659,20106215643,20076085936,20118151047,27167933667,27304489672,27223294982,20045368816,27065532331,23325554819,24332957496,20217102198,20224198478,20045444865,20308154190,27340567612,24346303790,20295912376,20284904584,23121050099,20082363530,27245994651,23235703459,20271876840,20287302151,20187807795,23166262089,23235336529,20253765322,20138011756,20118758324,27321877120,27138553138,27267350901,27173645924,20129461080,27188463512,27236853395,20250961902,27937094383,27343744949,20245032189,23297760114,20165212712,23202885209,23242560299,20250395087,20246623733,27254802323,27219053555,27276221618,27168800385,20219193158,20282339251,20248231891,20275447707,20168345311,20162079345,20178670183,20284712952,20164283691,20168916400,20232767007,27941243954,20176486865,20179329353,27166481851,20295204681,27284967653,27202347938,20234731204,23184909189,20261205751,20232283573,20149777920,20262010075,20100853125,20173637188,20078385589,27143397675,23147605439,220128820893,20138393748,20128820893,20133052861,27252843952,23244967672,20110617381,20147437626,23312586649,23264563739,20386858676,20252489410,20222519838,27163351868,20084144380,20184146089,20113627434,20229632567,27063741294,20289194038,27242713880,27181421067,20124532117,20344364134,20285088489,23162468979,20083899876,23051201914,20283141232,20041604000,20164876072,20257881475,20320513961,20307436192,23075210299,27163226753,20340981155,20261653959,20312271126,20173320974,20148731072,20175351931,20123516150,20137594250,20085081013,27140332432,23222296064,27307083626,20169101540,20133805614,20101389244,23084102059,20182677966,20049628391,20308341721,20244967672,27046681318,20217234965,27128523818,27174115015,20270268251,20201962243,20251885908,20258956088,20115941667,27294800986,20228261182,20103998116,20315769311,20359924748,23186402359,20242325622,20149980173,20236263666,20045940803,20250151994,20102017030,20178367006,27274642322,20169751154) " & vbCrLf &
                               "and a.nro_archivo is null"

        Dim rsA As ADODB.Recordset = nvFW.nvDBUtiles.DBOpenRecordset(strSQL)
        While rsA.EOF = False

            Dim archivo As tnvArchivo
            archivo = New tnvArchivo(id_tipo:=rsA.Fields("nro_entidad").Value, nro_archivo_id_tipo:=rsA.Fields("nro_archivo_id_tipo").Value, nro_def_detalle:=rsA.Fields("nro_def_detalle").Value, isFisical:=True)
            archivo.save()

            nvFW.nvDBUtiles.DBExecute("update archivos set momento = convert(datetime,'" & rsA.Fields("fe_alta").Value & "',103) where nro_archivo = " & archivo.nro_archivo.tostring)

            If IsDBNull(rsA.Fields("fe_venc").Value) = False Then
                nvFW.nvDBUtiles.DBExecute("update archivos_parametros set parametro_valor = convert(datetime,'" & rsA.Fields("fe_venc").Value & "',103) where parametro = 'ar_fe_forzar' and nro_archivo = " & archivo.nro_archivo.tostring)
            End If

            nvArchivo.recalcacular_vencimientos_archivo(archivo.nro_archivo)

            rsA.MoveNext()
        End While


    Catch ex As Exception
        err.numError = -99
        err.mensaje = ex.Message.ToString
    End Try

    err.response()
%>

